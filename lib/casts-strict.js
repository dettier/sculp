////////////////////////////////////////////////////////////////////////////////
// REQUIRES : BEGIN
////////////////////////////////////////////////////////////////////////////////

import isNumber from 'lodash-compat/lang/isNumber';
import isBoolean from 'lodash-compat/lang/isBoolean';
import isDate from 'lodash-compat/lang/isDate';
import isFunction from 'lodash-compat/lang/isFunction';
import isString from 'lodash-compat/lang/isString';
import isObject from 'lodash-compat/lang/isObject';
import isArray from 'lodash-compat/lang/isArray';

import { Type, CAST_ERROR } from './enums';

////////////////////////////////////////////////////////////////////////////////
// REQUIRES : END
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// CASTS_STRICT
////////////////////////////////////////////////////////////////////////////////

const CASTS_STRICT = {

  //////////////////////////////////////////////////////////////////////////////
  // STRING
  //////////////////////////////////////////////////////////////////////////////

  [Type.STRING] (v) {
    if (isString(v))
      return v;

    return CAST_ERROR;
  },

  //////////////////////////////////////////////////////////////////////////////
  // STRING NOT EMPTY TRIMMED
  //////////////////////////////////////////////////////////////////////////////

  [Type.STRING_NET] (v) {
    let res = CASTS_STRICT[Type.STRING](v);

    if (res !== CAST_ERROR) {
      res = res.trim();
      if (res === '')
        res = undefined;
    }

    return res;
  },

  //////////////////////////////////////////////////////////////////////////////
  // NUMBER
  //////////////////////////////////////////////////////////////////////////////

  [Type.NUMBER] (v) {
    if (isNumber(v)) {
      if (isNaN(v))
        return CAST_ERROR;
      return v;
    }

    return CAST_ERROR;
  },

  //////////////////////////////////////////////////////////////////////////////
  // DATE
  //////////////////////////////////////////////////////////////////////////////

  [Type.DATE] (v) {
    if (isDate(v))
      return new Date(v.getTime());

    return CAST_ERROR;
  },

  //////////////////////////////////////////////////////////////////////////////
  // FUNCTION
  //////////////////////////////////////////////////////////////////////////////

  [Type.FUNCTION] (v) {
    if (isFunction(v))
      return v;

    return CAST_ERROR;
  },

  //////////////////////////////////////////////////////////////////////////////
  // BOOLEAN
  //////////////////////////////////////////////////////////////////////////////

  [Type.BOOLEAN] (v) {
    if (isBoolean(v))
      return v;

    return CAST_ERROR;
  },

  //////////////////////////////////////////////////////////////////////////////
  // ANY_VALUE
  //////////////////////////////////////////////////////////////////////////////

  [Type.ANY_VALUE] (v) {
    return v;
  },

  //////////////////////////////////////////////////////////////////////////////
  // ANY_OBJECT
  //////////////////////////////////////////////////////////////////////////////

  [Type.ANY_OBJECT] (v) {
    if (isObject(v) && !isArray(v))
      return v;
    return CAST_ERROR;
  }

};

export default CASTS_STRICT;
